<!doctype html><html><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns#"><title>Buck: Build Rule</title><link type="image/png" rel="icon" href="/buck/favicon.png" /><meta http-equiv="content-type" content="text/html;charset=utf-8"><link type="text/css" rel="stylesheet" href="/buck/buck.css"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-40185670-1', 'github.io'); ga('send', 'pageview');</script><meta property="og:locale" content="en_US"><meta property="og:title" content="Build Rule"><meta property="og:site_name" content="Buck: an Android build tool"><meta property="og:image" content="http://newsroom.fb.com/display-media/265/4"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content="690"><meta property="og:image:height" content="690"><meta property="og:type" content="article"><meta property="fb:admins" content="584556688222168"></head><body><a href="https://github.com/facebook/buck"><img id="fork" src="/buck/fork_me.png" alt="Fork me on GitHub"></a><div id="fb-root"></div><script>(function(d, s, id) {var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=584556688222168"; fjs.parentNode.insertBefore(js, fjs);}(document, 'script', 'facebook-jssdk'));</script><h1><div class="titlebar"><div class="fb-like buck_like" data-send="false" data-layout="standard" data-width="350" data-show-faces="false" data-colorscheme="light" data-action="like"></div><div>Buck: Build Rule</div></div></h1><div class="content_frame"><div class="toc"><ul class="toc_root"><li><span class="toc_header">Getting Started</span><ul><li><a href="/buck/">Overview</a><li><a href="/buck/setup/quickstart.html">Quick Start</a><li><a href="/buck/setup/install.html">Downloading and Installing Buck</a></ul><li><span class="toc_header">Concepts</span><ul><li><a href="/buck/concept/build_rule.html">Build Rule</a><li><a href="/buck/concept/build_target.html">Build Target</a><li><a href="/buck/concept/build_file.html">Build File</a><li><a href="/buck/concept/buckversion.html">.buckversion</a><li><a href="/buck/concept/nobuckcheck.html">.nobuckcheck</a><li><a href="/buck/concept/buckconfig.html">.buckconfig</a><li><a href="/buck/concept/build_target_pattern.html">Build Target Pattern</a><li><a href="/buck/concept/visibility.html">Visibility</a><li><a href="/buck/concept/troubleshooting.html">Troubleshooting</a><li><a href="/buck/concept/faq.html">FAQ</a></ul><li><span class="toc_header">Build Rules</span><ul><li><a href="/buck/rule/android_binary.html">android_binary()</a><li><a href="/buck/rule/android_library.html">android_library()</a><li><a href="/buck/rule/android_resource.html">android_resource()</a><li><a href="/buck/rule/apk_genrule.html">apk_genrule()</a><li><a href="/buck/rule/gen_aidl.html">gen_aidl()</a><li><a href="/buck/rule/genrule.html">genrule()</a><li><a href="/buck/rule/java_binary.html">java_binary()</a><li><a href="/buck/rule/java_library.html">java_library()</a><li><a href="/buck/rule/java_test.html">java_test()</a><li><a href="/buck/rule/keystore.html">keystore()</a><li><a href="/buck/rule/ndk_library.html">ndk_library()</a><li><a href="/buck/rule/prebuilt_jar.html">prebuilt_jar()</a><li><a href="/buck/rule/prebuilt_native_library.html">prebuilt_native_library()</a><li><a href="/buck/rule/project_config.html">project_config()</a></ul><li><span class="toc_header">Functions</span><ul><li><a href="/buck/function/genfile.html">genfile()</a><li><a href="/buck/function/glob.html">glob()</a><li><a href="/buck/function/include_defs.html">include_defs()</a></ul><li><span class="toc_header">Commands</span><ul><li><a href="/buck/command/audit.html">buck audit</a><li><a href="/buck/command/build.html">buck build</a><li><a href="/buck/command/clean.html">buck clean</a><li><a href="/buck/command/install.html">buck install</a><li><a href="/buck/command/project.html">buck project</a><li><a href="/buck/command/targets.html">buck targets</a><li><a href="/buck/command/test.html">buck test</a><li><a href="/buck/command/uninstall.html">buck uninstall</a><li><a href="/buck/command/buckd.html">buckd</a></ul><li><span class="toc_header">Extending Buck</span><ul><li><a href="/buck/extending/macros.html">Custom Macros</a><li><a href="/buck/extending/rules.html">Custom Rules</a></ul><li><span class="toc_header">Contributing to Buck</span><ul><li><a href="https://groups.google.com/group/buck-build">Discussion Group</a><li><a href="https://github.com/facebook/buck/issues/new">Report a Bug</a><li><a href="/buck/contributing/development.html">Development Workflow</a><li><a href="/buck/contributing/codestyle.html">Code Style</a><li><a href="/buck/javadoc">API</a><li><a href="https://github.com/facebook/buck">Browse the Source Code</a></ul></ul></div><div class="content"><div class="overview">A <strong>build rule</strong> is a procedure for producing an output file from a set of input files.<p>Buck comes with a number of built-in build rules, as there are many common procedures when building Android code. For example, compiling Java code against the Android SDK is one of the most common operations, so the build rule <a href="/buck/rule/android_library.html"><code>android_library</code></a> exists to facilitate that. Similarly, the primary objective of most Android developers is to create an APK, so the build rule <a href="/buck/rule/android_binary.html"><code>android_binary</code></a> can be used to do that.<p>Build rules are defined using built-in Python functions in a <a href="build_file.html">build file</a>. (Both the Python function to define the rule and the corresponding Java object that is ultimately created to carry out the procedure are referred to as "the build rule," even though they are technically different things.) Every build rule takes at least the following three arguments:<ul><li><code>name</code> The name of the build rule, which must be unique within a build file.<li><code>deps</code> The build rule's dependencies, expressed as a list of build targets.<li><code>visibility</code> The set of build rules that are allowed to claim this rule as a dependency, expressed as a list of <a href="build_target_pattern.html">build target patterns</a>.</ul><p>In Buck, every build rule can produce zero or one output files. These output files can be used by other rules that declare the rule responsible for the output file as a dependency. For example, the output of an <a href="/buck/rule/android_library.html"><code>android_library</code></a> is a JAR file, so an <a href="/buck/rule/android_binary.html"><code>android_binary</code></a> that declares the <code>android_library</code> as a dependency can include the <code>.class</code> files from the <code>android_library</code>'s JAR file in its resulting APK. Or when one <code>android_library</code> depends on another, the JAR of dependent rule will be included on the classpath when the rule that depends on it compiles its Java code. Check the documentation for each build rule to see how it uses its <code>deps</code>. Note that no matter how a rule uses its <code>deps</code>, every rule in a rule's <code>deps</code> is guaranteed to be built before the rule attempts to build itself.<p>Build rules and their dependencies define a directed graph. Buck requires that this graph be acyclic. This helps Buck build efficiently, as it makes it easier to build independent subgraphs in parallel.<p>Although Buck tries to provide a rich set of built-in build rules for Android developers, it will not be able to address all possible needs. As an "escape hatch," Buck also provides a vanilla build rule called a <a href="/buck/rule/genrule.html"><code>genrule</code></a>, which can be used to build an arbitrary file using a Bash script.<p>Finally, note that build files are evaluated as Python files. This means that you can define your own functions within build files that generate build rules. This should not be something that you need to do often, but taking advantage of this may help you add something to Buck's build process without editing its source code. For more details on this topic, see the article on <a href="/buck/extending/macros.html">macros</a>.</div></div></div></body></html>